name: CI - train and save the model

on:
    push:
        branches: [main]
    pull_request:
        branches: [main]

jobs:
    matrix-pip:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                python-version: [3.11, 3.12]

        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: setup python
              uses: actions/setup-python@v4
              with:
                python-version: ${{ matrix.python-version }}

            - name: upgrade pip
              run: python -m pip install --upgrade pip setuptools wheel

            - name: install project dependencies
              run: python -m pip install -r requirements.txt
              
            - name: Train the model
              run: |
               python train.py
               ls -ls artifacts
               
            - name: upload the artifacts
              uses: actions/upload-artifacts@v4
              with:
                name: ml-artifacts-${{matrix.python}}-${{github.run_id}} 
                path: artifacts
            